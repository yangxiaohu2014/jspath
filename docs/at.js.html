<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>at.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#arcToCurve">arcToCurve</a></li><li><a href="global.html#at">at</a></li><li><a href="global.html#binarySearch">binarySearch</a></li><li><a href="global.html#createPathElement">createPathElement</a></li><li><a href="global.html#cut">cut</a></li><li><a href="global.html#cutArc">cutArc</a></li><li><a href="global.html#cutBezier">cutBezier</a></li><li><a href="global.html#cutLine">cutLine</a></li><li><a href="global.html#fix">fix</a></li><li><a href="global.html#flattern">flattern</a></li><li><a href="global.html#getArcCenter">getArcCenter</a></li><li><a href="global.html#getShapes">getShapes</a></li><li><a href="global.html#rotatingPoint">rotatingPoint</a></li><li><a href="global.html#shapesToArray">shapesToArray</a></li><li><a href="global.html#sub">sub</a></li><li><a href="global.html#sweepAngle">sweepAngle</a></li><li><a href="global.html#toAbsolute">toAbsolute</a></li><li><a href="global.html#toArray">toArray</a></li><li><a href="global.html#toCurve">toCurve</a></li><li><a href="global.html#toNormalize">toNormalize</a></li><li><a href="global.html#toRelative">toRelative</a></li><li><a href="global.html#toString">toString</a></li><li><a href="global.html#transformCoord">transformCoord</a></li><li><a href="global.html#tween">tween</a></li><li><a href="global.html#upgradeBezier">upgradeBezier</a></li><li><a href="global.html#upgradeToCurve">upgradeToCurve</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">at.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import createPathElement from './createPathElement'
import isArray from './isArray'
import toString from './toString'
import {precision} from './config'

/**
 * @name at
 * @description 获取曲线上某一个位置的点坐标、切线单位向量、倾斜角弧度值表示
 * @function
 * @since 0.1.0
 * @param  {Array|String} path [包含命令的路径参数数组或者字符]
 * @param  {Number} t     [相对路径的位置比例，[0, 1]]
 * @returns {Object}        [分割得到定的两条贝塞尔曲线的参数数组]
 *         {point, unitVector, rad}
 * @example
 *
 * at('M100,100A120,60,-60,0,0,150,325', .2)
 * // => {"point":[47.88,168.15],"unitVector":[-0.106,0.994],"rad":1.677}
 *
 * at('M100,100A120,60,-60,0,0,150,325', 0)
 * // => {"point":[100,100],"unitVector":[-0.958,-0.286],"rad":-2.852}
 *
 * at('M100,100A120,60,-60,0,0,150,325', 1)
 * // => {"point":[150,325],"unitVector":[0.712,-0.703],"rad":-0.779}
 *
 * at('M10 10 h 80 v 80 h -80 Z', 0.5)
 * // => {"point":[90,90],"unitVector":[-0.707,0.707],"rad":2.356}
 *
 * at('M10 10 h 80 v 80 h -80 Z', 0.2)
 * // => {"point":[74,10],"unitVector":[1,0],"rad":0}
 */

function at(pathString, t = 0) {
  const math = Math
	var pathEl = createPathElement(isArray(pathString) ? toString(pathString) : pathString)
	var len = pathEl.getTotalLength()
	var point = pathEl.getPointAtLength(t * len)
	var behindPoint = pathEl.getPointAtLength((t + 0.0001) * len)
	var beforePoint = pathEl.getPointAtLength((t - 0.0001) * len)
  var vector = [behindPoint.x - beforePoint.x, behindPoint.y - beforePoint.y]
  var vectorMod = math.sqrt(math.pow(vector[0], 2) + math.pow(vector[1], 2))
  var unitVector = [vector[0] / vectorMod, vector[1] / vectorMod]//切线的单位向量表示
  var tanRad = math.atan(unitVector[1] / unitVector[0])
  var rad //点处的倾斜角的弧度值

  if (math.abs(unitVector[0]) &lt;= precision) {
    rad = unitVector[1] > 0 ? (math.PI * .5) : (-math.PI * .5)
  } else if (unitVector[0] > 0) {
    rad = tanRad
  } else {
    rad = unitVector[1] > 0 ? (math.PI + tanRad) : (-math.PI + tanRad)
  }

  return {
    point: fix([point.x, point.y], 3),
    unitVector: fix(unitVector, 3),
    rad: fix(rad, 3)
  }
}

export default at
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Dec 22 2017 19:48:55 GMT+0800 (CST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
